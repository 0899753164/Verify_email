
<?php
ob_start();
session_start();
require 'config.inc.php';
require "class.phpmailer.php";

function showMessage($mess, $url) {
    print "<script language = 'JavaScript'>alert('".$mess."');</script>";
    if ($url != "0") {
        print  "<meta http-equiv=\"refresh\" content=\"0;url=$url\">";
    }
}
$da_time = date("Y-m-d");
$email =htmlspecialchars($_POST["email"], ENT_QUOTES);

// 
// Check mail type
if($_POST["mail_type"] !=''){
    $type_mail =htmlspecialchars($_POST["mail_type"], ENT_QUOTES);
    $mail_format =$email.''.$type_mail;
    $get_mail = filter_var($mail_format, FILTER_VALIDATE_EMAIL);
    
}else{
    echo "<script>alert('รูปแบบอีเมล์ไม่ถูกต้อง กรุณาเลือกประเภทอีเมล์ ');</script>";
    echo "<script>window.location='';</script>";
}
//////////////////////////////////// Verify email //////////////////////////
    // Verify mail
    // Include library file
    // Keyword "Verify Email Address and Check if Email is Real using PHP"
    // Refference https://www.codexworld.com/verify-email-address-check-if-real-exists-domain-php/
    require_once '../VerifyEmail.class.php'; 

    // Initialize library class
    $mail = new VerifyEmail();

    // Set the timeout value on stream
    $mail->setStreamTimeoutWait(20);

    // Set debug output mode
    $mail->Debug= FALSE; 
    $mail->Debugoutput= 'html'; 

    // Set email address for SMTP request
        //company@gmail.com
    $mail->setEmailFrom('');

    // Email to check value from post
    $emailVerify = $get_mail; 

    // Check if email is valid and exist
    if($mail->check($emailVerify)){ 
        // อีเมล์มีอยู่จริง
      //  echo 'Email &lt;'.$emailVerify.'&gt; is exist!';

    }elseif(verifyEmail::validate($emailVerify)){ 
        // รูปแบบอีเมล์ถูกต้อง แต่ไม่พบที่อยู่ หรืออีเมล์ไม่มีอยู่จริง
        echo "<script>alert('ไม่พบที่อยู่อีเมล์ของคุณ! กรุณาตรวจสอบอีเมล์ให้ถูกต้อง');</script>";
        echo "<script>window.location='';</script>";
    }else{
        // ไม่พบที่อยู่อีเมล์หรือ อีเมล์ปลอม
        echo "<script>alert('อีเมล์นี้ไม่มีอยู่จริง ไม่พบที่อยู่อีเมล์ กรุณาตรวจสอบอีเมล์ให้ถูกต้อง!');</script>";
        echo "<script>window.location='';</script>";
    }
/////////////////////////////////////// 
// die();
// 
$type =$new = htmlspecialchars($_POST["type"], ENT_QUOTES);
$fname =htmlspecialchars($_POST["fname"], ENT_QUOTES);
$lname =htmlspecialchars($_POST["lname"], ENT_QUOTES);
$pass =htmlspecialchars($_POST["pass"], ENT_QUOTES);
$phone =htmlspecialchars($_POST["phone"], ENT_QUOTES);

// match phone
$tel = $phone;
// Check format 3-7
if(preg_match("/^[0-9]{3}-[0-9]{7}$/", $tel)) {
    // valid | รูปแบบถูกต้อง
    // Validate Start number
    // ตรวจสอบเลขนำหน้า 06,08,09 เท่านั้น
    if(substr($tel, 0, 2) == '06' || substr($tel, 0, 2) == '08' || substr($tel, 0, 2) == '09'){
        // valid start number
        // ตรวจสอบ หมายเลขมั่ว
        $datanum=array("061-0987654","061-9876543", "061-8765432","061-7654321", "061-1231231","061-1212121","061-2121212","061-1313131","061-1414141",
        "061-1515151","061-1616161","061-1717171","061-1818181","061-1919191","061-1010101", "061-0101010", "061-2345678","062-3456789","063-2345678",
        "064-2345678","065-2345678","066-2345678","067-2345678","068-2345678","069-2345678","060-0000000","061-1111111","061-2222222","061-3333333",
        "061-4444444","061-5555555","061-6666666","061-7777777","061-8888888","061-9999999","061-0000000","062-1111111","062-2222222","062-3333333",
        "062-4444444","062-5555555","062-6666666","062-7777777","062-8888888","062-9999999","062-0000000","063-1111111","063-2222222","063-4444444",
        "063-5555555","063-6666666","063-7777777","063-8888888","063-9999999","063-0000000","064-1111111","064-2222222","064-3333333","064-4444444",
        "064-5555555","064-6666666","064-7777777","064-8888888","064-9999999","064-0000000","065-1111111","065-2222222","065-3333333","065-4444444",
        "065-5555555","065-6666666","065-7777777","065-8888888","065-9999999","065-0000000","666-1111111","666-2222222","666-3333333","666-4444444",
        "666-5555555","666-6666666","666-7777777","666-8888888","666-9999999","666-0000000","667-1111111","667-2222222","667-3333333","667-4444444",
        "667-5555555","667-5555555","667-7777777","667-8888888","667-9999999","667-0000000","668-1111111","668-2222222","668-3333333","668-4444444",
        "668-5555555","668-6666666","668-9999999","668-0000000","669-1111111","669-2222222","669-3333333","669-4444444","669-5555555","669-6666666",
        "669-7777777","669-8888888","669-0000000","660-1111111","660-2222222","660-3333333","660-4444444","660-5555555","660-6666666","660-7777777",
        "660-8888888","660-9999999","660-0000000",

        "081-0987654","081-9876543", "081-8765432","081-7654321", "081-1231231","081-1212121","081-2121212","081-1313131","081-1414141",
        "081-1515151","081-1616161","081-1717171","081-1818181","081-1919191","081-1010101", "081-0101010", "081-2345678","082-3456789","083-2345678",
        "084-2345678","085-2345678","086-2345678","087-2345678","088-2345678","089-2345678","080-0000000","081-1111111","081-2222222","081-3333333",
        "081-4444444","081-5555555","081-6666666","081-7777777","081-8888888","081-9999999","081-0000000","082-1111111","082-2222222","082-3333333",
        "082-4444444","082-5555555","082-6666666","082-7777777","082-8888888","082-9999999","082-0000000","083-1111111","083-2222222","083-4444444",
        "063-5555555","083-6666666","083-7777777","083-8888888","083-9999999","083-0000000","084-1111111","084-2222222","084-3333333","084-4444444",
        "064-5555555","084-6666666","084-7777777","084-8888888","084-9999999","084-0000000","085-1111111","085-2222222","085-3333333","085-4444444",
        "085-5555555","085-6666666","085-7777777","085-8888888","085-9999999","085-0000000","866-1111111","866-2222222","866-3333333","866-4444444",
        "866-5555555","866-6666666","866-7777777","866-8888888","866-9999999","866-0000000","867-1111111","867-2222222","867-3333333","867-4444444",
        "867-5555555","867-5555555","867-7777777","867-8888888","867-9999999","867-0000000","868-1111111","868-2222222","868-3333333","868-4444444",
        "868-5555555","868-6666666","868-9999999","868-0000000","869-1111111","869-2222222","869-3333333","869-4444444","869-5555555","869-6666666",
        "869-7777777","869-8888888","869-0000000","860-1111111","860-2222222","860-3333333","860-4444444","860-5555555","860-6666666","860-7777777",
        "860-8888888","860-9999999","860-0000000",

        "091-0987654","091-9876543", "091-8765432","091-7654321", "091-1231231","091-1212121","091-2121212","091-1313131","091-1414141",
        "091-1515151","091-1616161","091-1717171","091-1818181","091-1919191","091-1010101", "091-0101010", "091-2345678","092-3456789","093-2345678",
        "094-2345678","095-2345678","096-2345678","097-2345678","098-2345678","099-2345678","090-0000000","091-1111111","091-2222222","091-3333333",
        "091-4444444","091-5555555","091-6666666","091-7777777","091-8888888","091-9999999","091-0000000","092-1111111","092-2222222","092-3333333",
        "092-4444444","092-5555555","092-6666666","092-7777777","092-8888888","092-9999999","092-0000000","093-1111111","093-2222222","093-4444444",
        "093-5555555","093-6666666","093-7777777","093-8888888","093-9999999","093-0000000","094-1111111","084-2222222","094-3333333","094-4444444",
        "094-5555555","094-6666666","094-7777777","094-8888888","094-9999999","094-0000000","095-1111111","095-2222222","095-3333333","095-4444444",
        "095-5555555","095-6666666","095-7777777","095-8888888","095-9999999","095-0000000","966-1111111","966-2222222","966-3333333","966-4444444",
        "996-5555555","966-6666666","966-7777777","966-8888888","966-9999999","966-0000000","967-1111111","967-2222222","967-3333333","967-4444444",
        "997-5555555","967-5555555","967-7777777","967-8888888","967-9999999","967-0000000","968-1111111","968-2222222","968-3333333","968-4444444",
        "998-5555555","968-6666666","968-9999999","968-0000000","969-1111111","969-2222222","969-3333333","969-4444444","969-5555555","969-6666666",
        "999-7777777","969-8888888","969-0000000","960-1111111","960-2222222","960-3333333","960-4444444","960-5555555","960-6666666","960-7777777",
        "990-8888888","960-9999999","960-0000000"
        );
        // Check random number from input
        foreach($datanum as $value){
            if($tel == $value){
                echo $value.'='.$tel;
                echo "<script>alert('หมายเลขโทรศัพท์ไม่ถูกต้อง กรุณาตรวจสอบอีกครั้ง');</script>";
                echo "<script>window.location='';</script>";
            break;
            } else{}   
        }
    } else {
        echo "<script>alert('ไม่มีหมายเลข '".substr($tel, 0, 2).");</script>";
        echo "<script>window.location='';</script>";
    }
    // 
} else {
    echo "<script>alert('กรุณาใส่หมายเลขโทรศัทพ์ให้ครบ 10 หลัก');</script>";
    echo "<script>window.location='';</script>";
}
// 

    </body>
</html>
